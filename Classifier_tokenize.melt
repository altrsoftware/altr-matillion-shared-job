{"objects":[{"metadata":{"identifier":{"packageName":"altr.sharedjob.tokenize","name":"Classifier_tokenize","revision":3,"type":"DYNAMIC"},"rootJobReference":{"name":"Get Cols to Tokenize","type":"ORCHESTRATION","parameterMetadata":[{"slot":2,"variableName":"database","variableType":"SCALAR","displayName":"database","description":"Name of the database that the table to tokenize/protect is located in","defaultValue":[{"values":{"1":""}}],"defaultValueType":"TEXT","required":true},{"slot":3,"variableName":"schema","variableType":"SCALAR","displayName":"schema","description":"Name of the schema that the table to tokenize/protect is located in","defaultValue":[{"values":{"1":""}}],"defaultValueType":"TEXT","required":true},{"slot":4,"variableName":"table","variableType":"SCALAR","displayName":"table","description":"Name of the table to tokenize/protect","defaultValue":[{"values":{"1":""}}],"defaultValueType":"TEXT","required":true},{"slot":5,"variableName":"ef_database","variableType":"SCALAR","displayName":"ef_database","description":"Database that the external functions to tokenize/detokenize are located in","defaultValue":[{"values":{"1":""}}],"defaultValueType":"TEXT","required":true},{"slot":6,"variableName":"ef_schema","variableType":"SCALAR","displayName":"ef_schema","description":"Schema that the external functions to tokenize/detokenize are located in","defaultValue":[{"values":{"1":""}}],"defaultValueType":"TEXT","required":true},{"slot":7,"variableName":"ef_tokenize_name","variableType":"SCALAR","displayName":"ef_tokenize_name","description":"Name of the Tokenization external function","defaultValue":[{"values":{"1":"ALTR_TOKENIZE"}}],"defaultValueType":"TEXT","required":true},{"slot":8,"variableName":"ef_detokenize_name","variableType":"SCALAR","displayName":"ef_detokenize_name","description":"Name of the Detokenization external function","defaultValue":[{"values":{"1":"ALTR_DETOKENIZE"}}],"defaultValueType":"TEXT","required":true},{"slot":9,"variableName":"snowflake_hostname","variableType":"SCALAR","displayName":"snowflake_hostname","description":"Your Snowflake hostname in the format \"example.snowflakecomputing.com\"","defaultValue":[{"values":{"1":"example.snowflakecomputing.com"}}],"defaultValueType":"TEXT","required":true},{"slot":10,"variableName":"s3_bucket_name","variableType":"SCALAR","displayName":"s3_bucket_name","description":"Name of your s3 bucket for staging.","defaultValue":[{"values":{"1":""}}],"defaultValueType":"TEXT","required":true},{"slot":11,"variableName":"altr_service_user_name","variableType":"SCALAR","displayName":"altr_service_user_name","description":"The Snowflake username of the ALTR service user","defaultValue":[{"values":{"1":null}}],"defaultValueType":"TEXT","required":true},{"slot":12,"variableName":"altr_service_user_password","variableType":"SCALAR","displayName":"altr_service_user_password","description":"Name of the Project Group Password for the ALTR service user","defaultValue":[{"values":{"1":null}}],"defaultValueType":"TEXT","required":true},{"slot":13,"variableName":"classifiers_to_tokenize","variableType":"GRID","displayName":"classifiers_to_tokenize","description":"","defaultValue":[],"defaultValueType":null,"required":true},{"slot":14,"variableName":"altr_api_key","variableType":"SCALAR","displayName":"altr_api_key","description":"ALTR api key - generated in Settings -> Preferences -> API","defaultValue":[{"values":{"1":null}}],"defaultValueType":"TEXT","required":true},{"slot":15,"variableName":"altr_api_secret_reference","variableType":"SCALAR","displayName":"altr_api_secret_reference","description":"Name of the Project Group Password for the ALTR api secret key   - generated in Settings -> Preferences -> API","defaultValue":[{"values":{"1":null}}],"defaultValueType":"TEXT","required":true}]},"orchestrationJobs":["Get Cols to Tokenize","Add and Tokenize"],"transformationJobs":[],"imageMetadata":{"componentIcon":"iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABYklEQVR42mNgoAwYAnEYwwCC9UB8BYiZB8JyIyD+C8T/gTh8IBywAWo5CF+mdygYA/E/JAeAcCg9HbAJzXIQvgTETPSw3BSL72E4hB4O2IzDchC+SOtQkMLje7qFwh4CDqB5KNgSEQpBtA6F3QQccB6IGWnpAGsiQiGQ1qGwk4ADztE6LRATCv4DHQpnKE0LhCoYSyJCwY8SB8wHYg4CarYTEQpkpQU7qO9yqBAKvuQ4YC9U82MiQmEbAQecJjUt2KP5KpeAenMiQsGHFAfsQ9P8BIg5CejZSsABJ4kNBQccvskjoM+MiFDwJsYBB3BofkpEKGwh4IAThELBiYABBRS0lmDYE58BBwloXkVhiwmEj+MKBWcCGkE+MyHCASZEhIIHNo2HCWjaRGGrGW8ouBLheyMK+w14Q+EIAcUbyChJNxIw8xgsFNwIKPwL7QVT0nfEhUF2MxwloGgdlfqP2PBRAHwgR8SToKRTAAAAAElFTkSuQmCC","smallIcon":"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAArUlEQVR42mNgwA8sgNibgQKwA4hPATEjOZotgfg/FHuRY8BOJANOkqqZHYjfIRkAwp6kGlKHZsAJUg3gB+K3aIZ4kGpIDZoBxwhp0ARiJiQ+HxZXuOMzYB8Qh6GJVRPrCgeogitYXPEGzRA3bAbsR1IQjiZXhWbAEXTNjgScyYvFFS7ICg6iSVZicWElmprDMAknNInXUBsZsLjiNZpaZ5DEITTBcjyxVIGm9hAAswVR7aC5TiAAAAAASUVORK5CYII="},"description":"Tokenize and land in immediately apply policy to allow detokenization","helpHtml":"<div class=\"mtln\"><img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABYklEQVR42mNgoAwYAnEYwwCC9UB8BYiZB8JyIyD+C8T/gTh8IBywAWo5CF+mdygYA/E/JAeAcCg9HbAJzXIQvgTETPSw3BSL72E4hB4O2IzDchC+SOtQkMLje7qFwh4CDqB5KNgSEQpBtA6F3QQccB6IGWnpAGsiQiGQ1qGwk4ADztE6LRATCv4DHQpnKE0LhCoYSyJCwY8SB8wHYg4CarYTEQpkpQU7qO9yqBAKvuQ4YC9U82MiQmEbAQecJjUt2KP5KpeAenMiQsGHFAfsQ9P8BIg5CejZSsABJ4kNBQccvskjoM+MiFDwJsYBB3BofkpEKGwh4IAThELBiYABBRS0lmDYE58BBwloXkVhiwmEj+MKBWcCGkE+MyHCASZEhIIHNo2HCWjaRGGrGW8ouBLheyMK+w14Q+EIAcUbyChJNxIw8xgsFNwIKPwL7QVT0nfEhUF2MxwloGgdlfqP2PBRAHwgR8SToKRTAAAAAElFTkSuQmCC\"><h3>Classifier_tokenize</h3><p style='white-space: pre-line; word-wrap: break-word;'>Tokenize and land in immediately apply policy to allow detokenization</p><h3>Properties</h3><table><tbody><tr><th>Property</th><th>Type</th><th>Description</th></tr><tr><td>database</td><td>Variable</td><td style='white-space: pre-line; word-wrap: break-word;'>Name of the database that the table to tokenize/protect is located in</td></tr><tr><td>schema</td><td>Variable</td><td style='white-space: pre-line; word-wrap: break-word;'>Name of the schema that the table to tokenize/protect is located in</td></tr><tr><td>table</td><td>Variable</td><td style='white-space: pre-line; word-wrap: break-word;'>Name of the table to tokenize/protect</td></tr><tr><td>ef_database</td><td>Variable</td><td style='white-space: pre-line; word-wrap: break-word;'>Database that the external functions to tokenize/detokenize are located in</td></tr><tr><td>ef_schema</td><td>Variable</td><td style='white-space: pre-line; word-wrap: break-word;'>Schema that the external functions to tokenize/detokenize are located in</td></tr><tr><td>ef_tokenize_name</td><td>Variable</td><td style='white-space: pre-line; word-wrap: break-word;'>Name of the Tokenization external function</td></tr><tr><td>ef_detokenize_name</td><td>Variable</td><td style='white-space: pre-line; word-wrap: break-word;'>Name of the Detokenization external function</td></tr><tr><td>snowflake_hostname</td><td>Variable</td><td style='white-space: pre-line; word-wrap: break-word;'>Your Snowflake hostname in the format &quot;example.snowflakecomputing.com&quot;</td></tr><tr><td>s3_bucket_name</td><td>Variable</td><td style='white-space: pre-line; word-wrap: break-word;'>Name of your s3 bucket for staging.</td></tr><tr><td>altr_service_user_name</td><td>Variable</td><td style='white-space: pre-line; word-wrap: break-word;'>The Snowflake username of the ALTR service user</td></tr><tr><td>altr_service_user_password</td><td>Variable</td><td style='white-space: pre-line; word-wrap: break-word;'>Name of the Project Group Password for the ALTR service user</td></tr><tr><td>classifiers_to_tokenize</td><td>Grid</td><td style='white-space: pre-line; word-wrap: break-word;'></td></tr><tr><td>altr_api_key</td><td>Variable</td><td style='white-space: pre-line; word-wrap: break-word;'>ALTR api key - generated in Settings -&gt; Preferences -&gt; API</td></tr><tr><td>altr_api_secret_reference</td><td>Variable</td><td style='white-space: pre-line; word-wrap: break-word;'>Name of the Project Group Password for the ALTR api secret key   - generated in Settings -&gt; Preferences -&gt; API</td></tr></tbody></table></div>","created":1677529908303},"orchestrationJobs":{"Get Cols to Tokenize":{"id":-2,"revision":1089,"created":1677529698725,"timestamp":1677529698725,"components":{"5277":{"id":5277,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-672,"y":32,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6453],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Start","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true,"status":{},"columnNames":[]}},"validationStatus":{},"status":{},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"5278":{"id":5278,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1043089869,"x":-256,"y":32,"width":32,"height":32,"inputConnectorIDs":[8008],"outputSuccessConnectorIDs":[5284],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GDLP Call"}}}},"visible":true,"status":{},"columnNames":[]},"2":{"slot":2,"name":"API","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ALTR Endpoints"}}}},"visible":false,"status":{},"columnNames":[]},"3":{"slot":3,"name":"API Environment","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Production"}}}},"visible":false,"status":{},"columnNames":[]},"4":{"slot":4,"name":"API Version","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"default"}}}},"visible":false,"status":{},"columnNames":[]},"5":{"slot":5,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"POST GDLP"}}}},"visible":true,"status":{},"columnNames":[]},"6":{"slot":6,"name":"Auth Method","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"POST GDLP_auth"}}}},"visible":false,"status":{},"columnNames":[]},"7":{"slot":7,"name":"Api Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false,"status":{},"columnNames":[]},"8":{"slot":8,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${altr_api_key}"}}}},"visible":true,"status":{},"columnNames":[]},"9":{"slot":9,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":"${altr_api_secret_reference}"}}}},"visible":true,"status":{},"columnNames":[]},"10":{"slot":10,"name":"OAuth","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{},"columnNames":[]},"11":{"slot":11,"name":"Page Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"1"}}}},"visible":true,"status":{},"columnNames":[]},"12":{"slot":12,"name":"URI Params","elements":{},"visible":true,"status":{},"columnNames":[]},"13":{"slot":13,"name":"Query Params","elements":{},"visible":true,"status":{},"columnNames":[]},"14":{"slot":14,"name":"Header Params","elements":{},"visible":true,"status":{},"columnNames":[]},"15":{"slot":15,"name":"Post Body","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"{\n  \"username\": \"${altr_service_user_name}\",\n  \"password\": \"${altr_service_user_password}\",\n  \"account\": \"${snowflake_hostname}\",\n  \"database\": \"${database}\",\n  \"schema\": \"${schema}\",\n  \"table\": \"${table}\",\n  \"row_limit\": 25\n}"}}}},"visible":true,"status":{},"columnNames":[]},"16":{"slot":16,"name":"Api Key Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{},"columnNames":[]},"17":{"slot":17,"name":"Api Key Value","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false,"status":{},"columnNames":[]},"18":{"slot":18,"name":"Bearer Token","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false,"status":{},"columnNames":[]},"22":{"slot":22,"name":"Profile","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ALTR Endpoints"}}}},"visible":true,"status":{},"columnNames":[]},"113":{"slot":113,"name":"Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://${s3_bucket_name}/"}}}},"visible":true,"status":{},"columnNames":[]},"114":{"slot":114,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true,"status":{},"columnNames":[]},"115":{"slot":115,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true,"status":{},"columnNames":[]},"116":{"slot":116,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true,"status":{},"columnNames":[]},"117":{"slot":117,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"API_RESULTS"}}}},"visible":true,"status":{},"columnNames":[]},"118":{"slot":118,"name":"Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{},"columnNames":[]}},"validationStatus":{},"status":{},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"5279":{"id":5279,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1155583855,"x":-128,"y":32,"width":32,"height":32,"inputConnectorIDs":[5284],"outputSuccessConnectorIDs":[5285],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GDLP Result To Grid"}}}},"visible":true,"status":{},"columnNames":[]},"2":{"slot":2,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Basic"}}}},"visible":true,"status":{},"columnNames":[]},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true,"status":{},"columnNames":[]},"4":{"slot":4,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"API_RESULTS"}}}},"visible":true,"status":{},"columnNames":[]},"6":{"slot":6,"name":"Table Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Data Value"}}}},"visible":true,"status":{},"columnNames":[]},"7":{"slot":7,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"/* Note: this query will be run as a subquery for the purposes of sampling the data.\n   As such it will be restricted by any subquery limitations specified by the current platform. */"}}}},"visible":false,"status":{},"columnNames":[]},"8":{"slot":8,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"column_json"}}}},"visible":true,"status":{},"columnNames":[]},"9":{"slot":9,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Data Value"}}}},"visible":true,"status":{},"columnNames":[]},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":true,"status":{},"columnNames":[]},"11":{"slot":11,"name":"Order By","elements":{},"visible":true,"status":{},"columnNames":[]},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":true,"status":{},"columnNames":[]},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":true,"status":{},"columnNames":[]},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true,"status":{},"columnNames":[]},"20":{"slot":20,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true,"status":{},"columnNames":[]}},"validationStatus":{},"status":{},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"5280":{"id":5280,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186829,"x":24,"y":32,"width":32,"height":32,"inputConnectorIDs":[5285],"outputSuccessConnectorIDs":[7504],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Parse GDLP, get columns to tokenize"}}}},"visible":true,"status":{},"columnNames":[]},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"from itertools import chain\n###\n# Variables are directly accessible: \n#   print (myvar)\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print (context.getGridVariable('mygridvar'))\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\n\ngrid_value = context.getGridVariable('column_json')\n\nclassifiers = context.getGridVariable('classifiers_to_tokenize')\nflatten_classifiers = list(chain.from_iterable(classifiers))\n\n\n\n\ncolumns = []\n\nfor finding in grid_value:\n  result = json.loads(finding[0])\n  if result[\"tag\"] in flatten_classifiers:\n    columns.append([result[\"column\"]])\n\n#loop through findings (for each individual text value I believe)\n#for finding in body[\"result\"][\"findings\"]:\n#  classifier = finding[\"infoType\"][\"name\"]\n#  likelihood = finding[\"infoType\"][\"likelihood\"]\n#  \n#  #loop through column location that the text value was in \n#  for location in finding[\"location\"][\"contentLocations\"]:\n#  \tcolumnName = location[\"recordLocation\"][\"fieldId\"][\"name\"]\n#    \n#    #if it is likely or above, and hasn't already been added to the list of columns, add it\n#    if columnName not in columns and likelihood in [\"VERY_LIKELY\", \"LIKELY\"]:\n#      columns.append(columnName)\n\n\ncontext.updateGridVariable('columns_to_tokenize', columns)\n\n\n\n\n"}}}},"visible":true,"status":{},"columnNames":[]},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 3"}}}},"visible":true,"status":{},"columnNames":[]},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true,"status":{},"columnNames":[]},"5":{"slot":5,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false,"status":{},"columnNames":[]}},"validationStatus":{},"status":{},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"5350":{"id":5350,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1043089869,"x":272,"y":32,"width":32,"height":32,"inputConnectorIDs":[7504],"outputSuccessConnectorIDs":[7492],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get ALTR DBs"}}}},"visible":true,"status":{},"columnNames":[]},"2":{"slot":2,"name":"API","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ALTR Endpoints"}}}},"visible":false,"status":{},"columnNames":[]},"3":{"slot":3,"name":"API Environment","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Production"}}}},"visible":false,"status":{},"columnNames":[]},"4":{"slot":4,"name":"API Version","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"default"}}}},"visible":false,"status":{},"columnNames":[]},"5":{"slot":5,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GET Databases"}}}},"visible":true,"status":{},"columnNames":[]},"6":{"slot":6,"name":"Auth Method","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GET Databases_auth"}}}},"visible":false,"status":{},"columnNames":[]},"7":{"slot":7,"name":"Api Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false,"status":{},"columnNames":[]},"8":{"slot":8,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${altr_api_key}"}}}},"visible":true,"status":{},"columnNames":[]},"9":{"slot":9,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":"${altr_api_secret_reference}"}}}},"visible":true,"status":{},"columnNames":[]},"10":{"slot":10,"name":"OAuth","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{},"columnNames":[]},"11":{"slot":11,"name":"Page Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"1"}}}},"visible":true,"status":{},"columnNames":[]},"12":{"slot":12,"name":"URI Params","elements":{},"visible":true,"status":{},"columnNames":[]},"13":{"slot":13,"name":"Query Params","elements":{},"visible":true,"status":{},"columnNames":[]},"14":{"slot":14,"name":"Header Params","elements":{},"visible":true,"status":{},"columnNames":[]},"15":{"slot":15,"name":"Post Body","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{},"columnNames":[]},"16":{"slot":16,"name":"Api Key Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{},"columnNames":[]},"17":{"slot":17,"name":"Api Key Value","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false,"status":{},"columnNames":[]},"18":{"slot":18,"name":"Bearer Token","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false,"status":{},"columnNames":[]},"22":{"slot":22,"name":"Profile","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ALTR Endpoints"}}}},"visible":true,"status":{},"columnNames":[]},"113":{"slot":113,"name":"Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://${s3_bucket_name}/"}}}},"visible":true,"status":{},"columnNames":[]},"114":{"slot":114,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true,"status":{},"columnNames":[]},"115":{"slot":115,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true,"status":{},"columnNames":[]},"116":{"slot":116,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true,"status":{},"columnNames":[]},"117":{"slot":117,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"API_RESULTS"}}}},"visible":true,"status":{},"columnNames":[]},"118":{"slot":118,"name":"Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{},"columnNames":[]}},"validationStatus":{},"status":{},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"5389":{"id":5389,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1155583855,"x":432,"y":32,"width":32,"height":32,"inputConnectorIDs":[7492],"outputSuccessConnectorIDs":[6128],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ALTR DB Result To Grid"}}}},"visible":true,"status":{},"columnNames":[]},"2":{"slot":2,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Basic"}}}},"visible":true,"status":{},"columnNames":[]},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true,"status":{},"columnNames":[]},"4":{"slot":4,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"API_RESULTS"}}}},"visible":true,"status":{},"columnNames":[]},"6":{"slot":6,"name":"Table Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Data Value"}}}},"visible":true,"status":{},"columnNames":[]},"7":{"slot":7,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"/* Note: this query will be run as a subquery for the purposes of sampling the data.\n   As such it will be restricted by any subquery limitations specified by the current platform. */"}}}},"visible":false,"status":{},"columnNames":[]},"8":{"slot":8,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"altr_db_json"}}}},"visible":true,"status":{},"columnNames":[]},"9":{"slot":9,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Data Value"}}}},"visible":true,"status":{},"columnNames":[]},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":true,"status":{},"columnNames":[]},"11":{"slot":11,"name":"Order By","elements":{},"visible":true,"status":{},"columnNames":[]},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":true,"status":{},"columnNames":[]},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":true,"status":{},"columnNames":[]},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true,"status":{},"columnNames":[]},"20":{"slot":20,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true,"status":{},"columnNames":[]}},"validationStatus":{},"status":{},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"5424":{"id":5424,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1043089869,"x":784,"y":32,"width":32,"height":32,"inputConnectorIDs":[7496],"outputSuccessConnectorIDs":[9676],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get ALTR Cols"}}}},"visible":true,"status":{},"columnNames":[]},"2":{"slot":2,"name":"API","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ALTR Endpoints"}}}},"visible":false,"status":{},"columnNames":[]},"3":{"slot":3,"name":"API Environment","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Production"}}}},"visible":false,"status":{},"columnNames":[]},"4":{"slot":4,"name":"API Version","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"default"}}}},"visible":false,"status":{},"columnNames":[]},"5":{"slot":5,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GET Data"}}}},"visible":true,"status":{},"columnNames":[]},"6":{"slot":6,"name":"Auth Method","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GET Data_auth"}}}},"visible":false,"status":{},"columnNames":[]},"7":{"slot":7,"name":"Api Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false,"status":{},"columnNames":[]},"8":{"slot":8,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${altr_api_key}"}}}},"visible":true,"status":{},"columnNames":[]},"9":{"slot":9,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":"${altr_api_secret_reference}"}}}},"visible":true,"status":{},"columnNames":[]},"10":{"slot":10,"name":"OAuth","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{},"columnNames":[]},"11":{"slot":11,"name":"Page Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"1"}}}},"visible":true,"status":{},"columnNames":[]},"12":{"slot":12,"name":"URI Params","elements":{},"visible":true,"status":{},"columnNames":[]},"13":{"slot":13,"name":"Query Params","elements":{},"visible":true,"status":{},"columnNames":[]},"14":{"slot":14,"name":"Header Params","elements":{},"visible":true,"status":{},"columnNames":[]},"15":{"slot":15,"name":"Post Body","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{},"columnNames":[]},"16":{"slot":16,"name":"Api Key Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{},"columnNames":[]},"17":{"slot":17,"name":"Api Key Value","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false,"status":{},"columnNames":[]},"18":{"slot":18,"name":"Bearer Token","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false,"status":{},"columnNames":[]},"22":{"slot":22,"name":"Profile","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ALTR Endpoints"}}}},"visible":true,"status":{},"columnNames":[]},"113":{"slot":113,"name":"Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://${s3_bucket_name}/"}}}},"visible":true,"status":{},"columnNames":[]},"114":{"slot":114,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true,"status":{},"columnNames":[]},"115":{"slot":115,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true,"status":{},"columnNames":[]},"116":{"slot":116,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true,"status":{},"columnNames":[]},"117":{"slot":117,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"API_RESULTS"}}}},"visible":true,"status":{},"columnNames":[]},"118":{"slot":118,"name":"Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{},"columnNames":[]}},"validationStatus":{},"status":{},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"5428":{"id":5428,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1155583855,"x":928,"y":32,"width":32,"height":32,"inputConnectorIDs":[9676],"outputSuccessConnectorIDs":[5631],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ALTR Col Result To Grid"}}}},"visible":true,"status":{},"columnNames":[]},"2":{"slot":2,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Basic"}}}},"visible":true,"status":{},"columnNames":[]},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true,"status":{},"columnNames":[]},"4":{"slot":4,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"API_RESULTS"}}}},"visible":true,"status":{},"columnNames":[]},"6":{"slot":6,"name":"Table Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Data Value"}}}},"visible":true,"status":{},"columnNames":[]},"7":{"slot":7,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"/* Note: this query will be run as a subquery for the purposes of sampling the data.\n   As such it will be restricted by any subquery limitations specified by the current platform. */"}}}},"visible":false,"status":{},"columnNames":[]},"8":{"slot":8,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"altr_column_json"}}}},"visible":true,"status":{},"columnNames":[]},"9":{"slot":9,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Data Value"}}}},"visible":true,"status":{},"columnNames":[]},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":true,"status":{},"columnNames":[]},"11":{"slot":11,"name":"Order By","elements":{},"visible":true,"status":{},"columnNames":[]},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":true,"status":{},"columnNames":[]},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":true,"status":{},"columnNames":[]},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true,"status":{},"columnNames":[]},"20":{"slot":20,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true,"status":{},"columnNames":[]}},"validationStatus":{},"status":{},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"5466":{"id":5466,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":1376,"y":32,"width":32,"height":32,"inputConnectorIDs":[9869],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[14571],"outputFalseConnectorIDs":[8862],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"If DB Added to ALTR"}}}},"visible":true,"status":{},"columnNames":[]},"2":{"slot":2,"name":"Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true,"status":{},"columnNames":[]},"3":{"slot":3,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"is_db_added"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"True"}}}},"visible":true,"status":{},"columnNames":[]},"4":{"slot":4,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true,"status":{},"columnNames":[]},"5":{"slot":5,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{},"columnNames":[]}},"validationStatus":{},"status":{},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"5630":{"id":5630,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186829,"x":1040,"y":32,"width":32,"height":32,"inputConnectorIDs":[5631],"outputSuccessConnectorIDs":[9869],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Parse ALTR Cols"}}}},"visible":true,"status":{},"columnNames":[]},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print (myvar)\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print (context.getGridVariable('mygridvar'))\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\n\n\n\n#[[123, 'Test DB', 'MATILLION_DEMO_ONE'], ...]\ndb_info = context.getGridVariable('id_to_db_name')\n\n#load in ALTR cols\ngrid_value = context.getGridVariable('altr_column_json')\nbody = json.loads(grid_value[0][0])\ncols_added = body[\"data\"][\"fields\"]\naltr_col_names = []\n#filter out columns from wrong db, schema, and table\nfor col in cols_added:\n  if col[\"databaseId\"] == database_id and col[\"tableName\"] == schema + \".\" + table:\n    altr_col_names.append(col[\"columnName\"])\n\nprint(\"ALTR column names\")\n#[['phone_number'], ['email'], ...]\ntokenize_column_list = context.getGridVariable('columns_to_tokenize')\n\n\n\n\n\ncols_to_add = []\n#loop through tokenize column list\nfor col in tokenize_column_list:\n  #check if not already added to altr\n  if col[0] not in altr_col_names:\n  \t#if not, add to list\n    cols_to_add.append(col)\n\n    \nprint(cols_to_add)\ncontext.updateGridVariable('columns_to_add_to_altr', cols_to_add)\n\n\n\n\n\n\n\n\n"}}}},"visible":true,"status":{},"columnNames":[]},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 3"}}}},"visible":true,"status":{},"columnNames":[]},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true,"status":{},"columnNames":[]},"5":{"slot":5,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false,"status":{},"columnNames":[]}},"validationStatus":{},"status":{},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"5787":{"id":5787,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1043089869,"x":1376,"y":512,"width":32,"height":32,"inputConnectorIDs":[8862],"outputSuccessConnectorIDs":[11117],"outputFailureConnectorIDs":[14575],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Add DB to ALTR"}}}},"visible":true,"status":{},"columnNames":[]},"2":{"slot":2,"name":"API","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ALTR Endpoints"}}}},"visible":false,"status":{},"columnNames":[]},"3":{"slot":3,"name":"API Environment","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Production"}}}},"visible":false,"status":{},"columnNames":[]},"4":{"slot":4,"name":"API Version","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"default"}}}},"visible":false,"status":{},"columnNames":[]},"5":{"slot":5,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"POST Database"}}}},"visible":true,"status":{},"columnNames":[]},"6":{"slot":6,"name":"Auth Method","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"POST Database_auth"}}}},"visible":false,"status":{},"columnNames":[]},"7":{"slot":7,"name":"Api Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false,"status":{},"columnNames":[]},"8":{"slot":8,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${altr_api_key}"}}}},"visible":true,"status":{},"columnNames":[]},"9":{"slot":9,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":"${altr_api_secret_reference}"}}}},"visible":true,"status":{},"columnNames":[]},"10":{"slot":10,"name":"OAuth","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{},"columnNames":[]},"11":{"slot":11,"name":"Page Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"1"}}}},"visible":true,"status":{},"columnNames":[]},"12":{"slot":12,"name":"URI Params","elements":{},"visible":true,"status":{},"columnNames":[]},"13":{"slot":13,"name":"Query Params","elements":{},"visible":true,"status":{},"columnNames":[]},"14":{"slot":14,"name":"Header Params","elements":{},"visible":true,"status":{},"columnNames":[]},"15":{"slot":15,"name":"Post Body","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"{\n    \"friendlyDatabaseName\": \"${database}\",\n    \"databaseType\": \"snowflake_external_functions\",\n    \"maxNumberOfConnections\": 5,\n    \"dataUsageHistory\": false,\n    \"hostname\": \"${snowflake_hostname}\",\n    \"databasePort\": 443,\n    \"databaseUsername\": \"${altr_service_user_name}\",\n    \"databasePassword\": \"${altr_service_user_password}\",\n    \"databaseName\": \"${database}\",\n    \"warehouseName\": null,\n    \"snowflakeRole\": null\n}"}}}},"visible":true,"status":{},"columnNames":[]},"16":{"slot":16,"name":"Api Key Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{},"columnNames":[]},"17":{"slot":17,"name":"Api Key Value","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false,"status":{},"columnNames":[]},"18":{"slot":18,"name":"Bearer Token","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false,"status":{},"columnNames":[]},"22":{"slot":22,"name":"Profile","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ALTR Endpoints"}}}},"visible":true,"status":{},"columnNames":[]},"113":{"slot":113,"name":"Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://${s3_bucket_name}/"}}}},"visible":true,"status":{},"columnNames":[]},"114":{"slot":114,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true,"status":{},"columnNames":[]},"115":{"slot":115,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true,"status":{},"columnNames":[]},"116":{"slot":116,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true,"status":{},"columnNames":[]},"117":{"slot":117,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"API_RESULTS"}}}},"visible":true,"status":{},"columnNames":[]},"118":{"slot":118,"name":"Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{},"columnNames":[]}},"validationStatus":{},"status":{},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"5832":{"id":5832,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":-424773870,"x":2528,"y":32,"width":32,"height":16,"inputConnectorIDs":[16804],"outputSuccessConnectorIDs":[9862],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Grid Iterator: columns_to_tokenize"}}}},"visible":true,"status":{},"columnNames":[]},"3":{"slot":3,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"columns_to_tokenize"}}}},"visible":true,"status":{},"columnNames":[]},"4":{"slot":4,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"column"},"2":{"slot":2,"type":"STRING","value":"column"}}}},"visible":true,"status":{},"columnNames":[]},"5":{"slot":5,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true,"status":{},"columnNames":[]},"6":{"slot":6,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sequential"}}}},"visible":true,"status":{},"columnNames":[]},"7":{"slot":7,"name":"Stop on Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true,"status":{},"columnNames":[]},"8":{"slot":8,"name":"Stop Condition Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":false,"status":{},"columnNames":[]},"9":{"slot":9,"name":"Condition","elements":{},"visible":false,"status":{},"columnNames":[]},"10":{"slot":10,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":false,"status":{},"columnNames":[]},"11":{"slot":11,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{},"columnNames":[]},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true,"status":{},"columnNames":[]}},"validationStatus":{},"status":{},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[16512],"inputIterationConnectorIDs":[]},"6063":{"id":6063,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186829,"x":576,"y":32,"width":32,"height":32,"inputConnectorIDs":[6128],"outputSuccessConnectorIDs":[7496],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Parse ALTR Dbs"}}}},"visible":true,"status":{},"columnNames":[]},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print (myvar)\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print (context.getGridVariable('mygridvar'))\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\n\ngrid_value = context.getGridVariable('altr_db_json')\n\n\nbody = json.loads(grid_value[0][0])\n\ndatabases = body[\"data\"][\"databases\"]\nis_db_found = \"False\"\n\nid_to_name = []\n\n#loop through findings (for each individual text value I believe)\nfor db in databases:\n  #map id to friendly db name\n  id_to_name.append([str(int(db[\"id\"])), db[\"friendlyDatabaseName\"], db[\"databaseName\"]])\n  if db[\"databaseName\"].lower() == database.lower():\n    is_db_found = \"True\"\n    context.updateVariable('database_id', db[\"id\"])\n\n\ncontext.updateGridVariable('id_to_db_name', id_to_name)\ncontext.updateVariable('is_db_added', is_db_found)"}}}},"visible":true,"status":{},"columnNames":[]},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 3"}}}},"visible":true,"status":{},"columnNames":[]},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true,"status":{},"columnNames":[]},"5":{"slot":5,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false,"status":{},"columnNames":[]}},"validationStatus":{},"status":{},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6452":{"id":6452,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-480,"y":32,"width":32,"height":32,"inputConnectorIDs":[6453],"outputSuccessConnectorIDs":[8008],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create Tag"}}}},"visible":true,"status":{},"columnNames":[]},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CREATE TAG IF NOT EXISTS ALTR_TOKENIZED \n\tALLOWED_VALUES 'true'; "}}}},"visible":true,"status":{},"columnNames":[]}},"validationStatus":{},"status":{},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"8982":{"id":8982,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1155583855,"x":2048,"y":512,"width":32,"height":32,"inputConnectorIDs":[11117],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[10431],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Added DB Result to Grid"}}}},"visible":true,"status":{},"columnNames":[]},"2":{"slot":2,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Basic"}}}},"visible":true,"status":{},"columnNames":[]},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true,"status":{},"columnNames":[]},"4":{"slot":4,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"API_RESULTS"}}}},"visible":true,"status":{},"columnNames":[]},"6":{"slot":6,"name":"Table Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Data Value"}}}},"visible":true,"status":{},"columnNames":[]},"7":{"slot":7,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"/* Note: this query will be run as a subquery for the purposes of sampling the data.\n   As such it will be restricted by any subquery limitations specified by the current platform. */"}}}},"visible":false,"status":{},"columnNames":[]},"8":{"slot":8,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"altr_db_json"}}}},"visible":true,"status":{},"columnNames":[]},"9":{"slot":9,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Data Value"}}}},"visible":true,"status":{},"columnNames":[]},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"50"}}}},"visible":true,"status":{},"columnNames":[]},"11":{"slot":11,"name":"Order By","elements":{},"visible":true,"status":{},"columnNames":[]},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":true,"status":{},"columnNames":[]},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":true,"status":{},"columnNames":[]},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true,"status":{},"columnNames":[]},"20":{"slot":20,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true,"status":{},"columnNames":[]}},"validationStatus":{},"status":{},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"8984":{"id":8984,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186829,"x":2192,"y":512,"width":32,"height":32,"inputConnectorIDs":[10431],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[14581],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get DB ID"}}}},"visible":true,"status":{},"columnNames":[]},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print (myvar)\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print (context.getGridVariable('mygridvar'))\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\n\n\n\ngrid_value = context.getGridVariable('altr_db_json')\nbody = json.loads(grid_value[0][0])\ncontext.updateVariable('database_id', body[\"data\"][\"id\"])\n\nid_to_name = context.getGridVariable('id_to_db_name')\nif id_to_name is None:\n  context.updateGridVariable('id_to_db_name', [[str(int(body[\"data\"][\"id\"])), body[\"data\"][\"friendlyDatabaseName\"], body[\"data\"][\"databaseName\"]]])\nelse:\n  id_to_name.append([str(int(body[\"data\"][\"id\"])), body[\"data\"][\"friendlyDatabaseName\"], body[\"data\"][\"databaseName\"]])\n  context.updateGridVariable('id_to_db_name', id_to_name)\n\n"}}}},"visible":true,"status":{},"columnNames":[]},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 3"}}}},"visible":true,"status":{},"columnNames":[]},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true,"status":{},"columnNames":[]},"5":{"slot":5,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false,"status":{},"columnNames":[]}},"validationStatus":{},"status":{},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"9849":{"id":9849,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1043089869,"x":2624,"y":32,"width":32,"height":32,"inputConnectorIDs":[9862],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Import Tags"}}}},"visible":true,"status":{},"columnNames":[]},"2":{"slot":2,"name":"API","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ALTR Endpoints"}}}},"visible":false,"status":{},"columnNames":[]},"3":{"slot":3,"name":"API Environment","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Production"}}}},"visible":false,"status":{},"columnNames":[]},"4":{"slot":4,"name":"API Version","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"default"}}}},"visible":false,"status":{},"columnNames":[]},"5":{"slot":5,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update DB"}}}},"visible":true,"status":{},"columnNames":[]},"6":{"slot":6,"name":"Auth Method","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update DB_auth"}}}},"visible":false,"status":{},"columnNames":[]},"7":{"slot":7,"name":"Api Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false,"status":{},"columnNames":[]},"8":{"slot":8,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${altr_api_key}"}}}},"visible":true,"status":{},"columnNames":[]},"9":{"slot":9,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":"${altr_api_secret_reference}"}}}},"visible":true,"status":{},"columnNames":[]},"10":{"slot":10,"name":"OAuth","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{},"columnNames":[]},"11":{"slot":11,"name":"Page Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"1"}}}},"visible":true,"status":{},"columnNames":[]},"12":{"slot":12,"name":"URI Params","elements":{},"visible":true,"status":{},"columnNames":[]},"13":{"slot":13,"name":"Query Params","elements":{},"visible":true,"status":{},"columnNames":[]},"14":{"slot":14,"name":"Header Params","elements":{},"visible":true,"status":{},"columnNames":[]},"15":{"slot":15,"name":"Post Body","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"{\n  \"dataUsageHistory\": false,\n  \"shouldClassify\": true,\n  \"classificationType\": 3,\n  \"databaseId\": ${database_id}\n}"}}}},"visible":true,"status":{},"columnNames":[]},"16":{"slot":16,"name":"Api Key Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{},"columnNames":[]},"17":{"slot":17,"name":"Api Key Value","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false,"status":{},"columnNames":[]},"18":{"slot":18,"name":"Bearer Token","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false,"status":{},"columnNames":[]},"22":{"slot":22,"name":"Profile","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ALTR Endpoints"}}}},"visible":true,"status":{},"columnNames":[]},"113":{"slot":113,"name":"Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://${s3_bucket_name}/"}}}},"visible":true,"status":{},"columnNames":[]},"114":{"slot":114,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true,"status":{},"columnNames":[]},"115":{"slot":115,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true,"status":{},"columnNames":[]},"116":{"slot":116,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true,"status":{},"columnNames":[]},"117":{"slot":117,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"API_RESULTS"}}}},"visible":true,"status":{},"columnNames":[]},"118":{"slot":118,"name":"Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{},"columnNames":[]}},"validationStatus":{},"status":{},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"14561":{"id":14561,"inputCardinality":"MANY","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":-1343684451,"x":2192,"y":32,"width":32,"height":32,"inputConnectorIDs":[14581,14571,14575],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[16804],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Join Paths"}}}},"visible":true,"status":{},"columnNames":[]}},"validationStatus":{},"status":{},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"16247":{"id":16247,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":-1180878087,"x":2528,"y":64,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Add and Tokenize"}}}},"visible":true,"status":{},"columnNames":[]},"2":{"slot":2,"name":"Job Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Add and Tokenize"}}}},"visible":true,"status":{},"columnNames":[]},"3":{"slot":3,"name":"","elements":{},"visible":false,"status":{},"columnNames":[]},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ef_database"},"2":{"slot":2,"type":"STRING","value":"${ef_database}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"ef_detokenize_name"},"2":{"slot":2,"type":"STRING","value":"${ef_detokenize_name}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"ef_schema"},"2":{"slot":2,"type":"STRING","value":"${ef_schema}"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"database"},"2":{"slot":2,"type":"STRING","value":"${database}"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"schema"},"2":{"slot":2,"type":"STRING","value":"${schema}"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"column"},"2":{"slot":2,"type":"STRING","value":"${column}"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"table"},"2":{"slot":2,"type":"STRING","value":"${table}"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"database_id"},"2":{"slot":2,"type":"STRING","value":"${database_id}"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"altr_api_key"},"2":{"slot":2,"type":"STRING","value":"${altr_api_key}"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"altr_api_secret_reference"},"2":{"slot":2,"type":"STRING","value":"${altr_api_secret_reference}"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"ef_tokenize_name"},"2":{"slot":2,"type":"STRING","value":"${ef_tokenize_name}"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"s3_bucket_name"},"2":{"slot":2,"type":"STRING","value":"${s3_bucket_name}"}}}},"visible":true,"status":{},"columnNames":[]},"5":{"slot":5,"name":"Set Grid Variables","elements":{"1":{"slot":1,"elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"columns_to_add_to_altr"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"column"}}}},"values":{"1":{"slot":1,"type":"STRING","value":"columns_to_add_to_altr"},"2":{"slot":2,"type":"STRING","value":"grid"}}}},"visible":true,"status":{},"columnNames":[]},"6":{"slot":6,"name":"Melt Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Classifier_tokenize"}}}},"visible":true,"status":{},"columnNames":[]},"7":{"slot":7,"name":"Melt Package","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"altr.sharedjob.tokenize"}}}},"visible":true,"status":{},"columnNames":[]},"8":{"slot":8,"name":"Melt Revision","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"3"}}}},"visible":true,"status":{},"columnNames":[]},"9":{"slot":9,"name":"Melt Load Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DYNAMIC"}}}},"visible":true,"status":{},"columnNames":[]}},"validationStatus":{},"status":{},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[16512]}},"successConnectors":{"5284":{"id":5284,"sourceID":5278,"targetID":5279},"5285":{"id":5285,"sourceID":5279,"targetID":5280},"5631":{"id":5631,"sourceID":5428,"targetID":5630},"6128":{"id":6128,"sourceID":5389,"targetID":6063},"7492":{"id":7492,"sourceID":5350,"targetID":5389},"7496":{"id":7496,"sourceID":6063,"targetID":5424},"7504":{"id":7504,"sourceID":5280,"targetID":5350},"8008":{"id":8008,"sourceID":6452,"targetID":5278},"9676":{"id":9676,"sourceID":5424,"targetID":5428},"9862":{"id":9862,"sourceID":5832,"targetID":9849},"9869":{"id":9869,"sourceID":5630,"targetID":5466},"11117":{"id":11117,"sourceID":5787,"targetID":8982}},"failureConnectors":{"14575":{"id":14575,"sourceID":5787,"targetID":14561}},"unconditionalConnectors":{"6453":{"id":6453,"sourceID":5277,"targetID":6452},"10431":{"id":10431,"sourceID":8982,"targetID":8984},"14581":{"id":14581,"sourceID":8984,"targetID":14561},"16804":{"id":16804,"sourceID":14561,"targetID":5832}},"trueConnectors":{"14571":{"id":14571,"sourceID":5466,"targetID":14561}},"falseConnectors":{"8862":{"id":8862,"sourceID":5466,"targetID":5787}},"iterationConnectors":{"16512":{"id":16512,"sourceID":5832,"targetID":16247}},"noteConnectors":{},"canUndo":true,"undoCommand":"Set Parameter","undoCreated":1677529695377,"canRedo":false,"redoCommand":"","redoCreated":1677521725216,"notes":{"14112":{"id":14112,"x":-298,"y":-187,"width":422,"height":275,"text":"**GDLP Classification**\n\n1. Runs classification on input table, saves results to __column_json__\n\n2. Compares classification results of each column to users selected classifications to tokenize\n\n3. Saves sensitive columns to __columns_to_tokenize__\n","colour":"e6e63c"},"14154":{"id":14154,"x":227,"y":-186,"width":402,"height":277,"text":"**Get ALTR Databases**\n\n1. Gets a list of databases from ALTR and saves results to __altr_db_json__\n\n2. Creates a list of databases [id, name] and saves it to __id_to_db_name__\n\n3. Checks if destination database is already added to ALTR and saves result to __is_db_added__\n\n","colour":"e6e63c"},"14256":{"id":14256,"x":-603,"y":-188,"width":261,"height":273,"text":"**Create Snowflake Tag**\n\n1. Creates tag (__ALTR_TOKENIZED__) in destination Snowflake database.\n","colour":"e6e63c"},"14284":{"id":14284,"x":731,"y":-179,"width":378,"height":272,"text":"**Get ALTR Columns**\n\n1. Gets a list of columns added to ALTR and saves results to __altr_column_json__\n\n2. Compares columns selected to tokenize (__columns_to_tokenize__) and the columns that are in ALTR\n\n3. Columns that are NOT in ALTR already, but were selected to be tokenized are added to list and saved to __columns_to_add_to_altr__ \n\n\n","colour":"e6e63c"},"14306":{"id":14306,"x":1133,"y":236,"width":298,"height":74,"text":"**Is destination database in ALTR: False**\n\nDatabase will be added to ALTR.","colour":"f9c21b"},"14319":{"id":14319,"x":1510,"y":102,"width":482,"height":164,"text":"**Add Database to ALTR: Failed**\n\n``    If:`` Database failed to add to ALTR because it is already in ALTR but was not caught previously\n\n1. Columns will be tokenized, tagged and added to ALTR\n\n``    Else If:`` Database failed to add to ALTR\n\n1. Columns will be tokenized, tagged BUT not added to ALTR\n","colour":"d60000"},"14330":{"id":14330,"x":1601,"y":445,"width":286,"height":88,"text":"**Add Database to ALTR: Passed**\n\nDatabase is now in ALTR.\nColumns will be tokenized, tagged and added to ALTR.","colour":"00ce4f"},"14347":{"id":14347,"x":1556,"y":-63,"width":334,"height":110,"text":"**Is destination database in ALTR: True**\n\n1. Database is already in ALTR.\n2. Selected columns will tokenized, tagged and added to ALTR","colour":"00ce4f"},"14371":{"id":14371,"x":2371,"y":-94,"width":314,"height":219,"text":"**Tokenize**\n\nTokenize columns, tag columns and add to ALTR","colour":"e6e63c"},"15163":{"id":15163,"x":-397,"y":181,"width":1220,"height":295,"text":"**Summary**\n\nThis integration is a Matillion shared job that will tokenize any columns in a table that match a user-created list of classifiers. ALTR will then govern the columns to allow policy to be placed over that column to allow for role-based detokenization.\n\n**Environment Variables**\n\n__database__  - name of destination database (Snowflake)\n__schema__  - name of destination schema \n__table__  - name of destination table\n__ef_database__ - name of database where external functions exists\n__ef_schema__ - name of schema where external functions exists\n__ef_tokenize_name__ - name of external function that calls (tokenize) ALTR's Tokenization API\n__ef_detokenize_name__ - name of external function that calls (detokenize) ALTR's Tokenization API\n__altr_api_key__ - Your ALTR API Key Name\n__altr_api_secret_reference__ - Your ALTR API Key Secret\n__snowflake_hostname__ - snowflake host name\n__altr_service_user_name__ - The Snowflake username of the ALTR service user\n__altr_service_user_password__ - The password for the ALTR service user\n__classifiers_to_tokenize__ - a list of classifiers that should be tokenized\n__s3_bucket_name__ - name of s3 bucket","colour":"e6e63c"}},"variables":{"table":{"definition":{"name":"table","type":"TEXT","scope":"TASKBATCH","description":"Name of the table to tokenize/protect","visibility":"PUBLIC"},"value":null},"column":{"definition":{"name":"column","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PRIVATE"},"value":null},"schema":{"definition":{"name":"schema","type":"TEXT","scope":"TASKBATCH","description":"Name of the schema that the table to tokenize/protect is located in","visibility":"PUBLIC"},"value":null},"database":{"definition":{"name":"database","type":"TEXT","scope":"TASKBATCH","description":"Name of the database that the table to tokenize/protect is located in","visibility":"PUBLIC"},"value":null},"ef_schema":{"definition":{"name":"ef_schema","type":"TEXT","scope":"TASKBATCH","description":"Schema that the tokenization external function is located in","visibility":"PUBLIC"},"value":null},"database_id":{"definition":{"name":"database_id","type":"DECIMAL","scope":"TASKBATCH","description":"","visibility":"PRIVATE"},"value":""},"ef_database":{"definition":{"name":"ef_database","type":"TEXT","scope":"TASKBATCH","description":"Database that the Tokenization external function is located in ","visibility":"PUBLIC"},"value":null},"is_db_added":{"definition":{"name":"is_db_added","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PRIVATE"},"value":""},"altr_api_key":{"definition":{"name":"altr_api_key","type":"TEXT","scope":"TASKBATCH","description":"ALTR api key - generated in Settings -> Preferences -> API","visibility":"PUBLIC"},"value":null},"s3_bucket_name":{"definition":{"name":"s3_bucket_name","type":"TEXT","scope":"TASKBATCH","description":"Name of your s3 bucket for staging.","visibility":"PUBLIC"},"value":""},"ef_tokenize_name":{"definition":{"name":"ef_tokenize_name","type":"TEXT","scope":"TASKBATCH","description":"Name of the Tokenization external function","visibility":"PUBLIC"},"value":null},"ef_detokenize_name":{"definition":{"name":"ef_detokenize_name","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":null},"snowflake_hostname":{"definition":{"name":"snowflake_hostname","type":"TEXT","scope":"TASKBATCH","description":"Your Snowflake hostname in the format \"example.snowflakecomputing.com\"","visibility":"PUBLIC"},"value":null},"altr_service_user_name":{"definition":{"name":"altr_service_user_name","type":"TEXT","scope":"TASKBATCH","description":"The Snowflake username of the ALTR service user","visibility":"PUBLIC"},"value":null},"altr_api_secret_reference":{"definition":{"name":"altr_api_secret_reference","type":"TEXT","scope":"TASKBATCH","description":"Name of the Project Group Password for the ALTR api secret key   - generated in Settings -> Preferences -> API","visibility":"PUBLIC"},"value":null},"altr_service_user_password":{"definition":{"name":"altr_service_user_password","type":"TEXT","scope":"TASKBATCH","description":"Name of the Project Group Password for the ALTR service user","visibility":"PUBLIC"},"value":null}},"grids":{"column_json":{"definition":{"name":"column_json","scope":"TASKBATCH","definitions":[{"name":"json","type":"TEXT"}],"description":"","visibility":"PRIVATE"},"values":[]},"altr_db_json":{"definition":{"name":"altr_db_json","scope":"TASKBATCH","definitions":[{"name":"db_json_body","type":"TEXT"}],"description":"","visibility":"PRIVATE"},"values":[]},"id_to_db_name":{"definition":{"name":"id_to_db_name","scope":"TASKBATCH","definitions":[{"name":"id","type":"DECIMAL"},{"name":"friendly_name","type":"TEXT"},{"name":"db_name","type":"TEXT"}],"description":"","visibility":"PRIVATE"},"values":[]},"tagged_columns":{"definition":{"name":"tagged_columns","scope":"TASKBATCH","definitions":[{"name":"tagged_column_name","type":"TEXT"}],"description":"","visibility":"PRIVATE"},"values":[]},"altr_column_json":{"definition":{"name":"altr_column_json","scope":"TASKBATCH","definitions":[{"name":"column_json_body","type":"TEXT"}],"description":"","visibility":"PRIVATE"},"values":[]},"columns_to_tokenize":{"definition":{"name":"columns_to_tokenize","scope":"TASKBATCH","definitions":[{"name":"column","type":"TEXT"}],"description":"","visibility":"PRIVATE"},"values":[]},"columns_to_add_to_altr":{"definition":{"name":"columns_to_add_to_altr","scope":"TASKBATCH","definitions":[{"name":"column","type":"TEXT"}],"description":"","visibility":"PRIVATE"},"values":[]},"classifiers_to_tokenize":{"definition":{"name":"classifiers_to_tokenize","scope":"TASKBATCH","definitions":[{"name":"Classifiers","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["PERSON_NAME"]},{"values":["EMAIL_ADDRESS"]}]}}},"Add and Tokenize":{"id":-2,"revision":268,"created":1677529745471,"timestamp":1677529745471,"components":{"6026":{"id":6026,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-128,"y":16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[16891],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Start","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true,"status":{},"columnNames":[]}},"validationStatus":{},"status":{},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6031":{"id":6031,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":80,"y":16,"width":32,"height":32,"inputConnectorIDs":[16891],"outputSuccessConnectorIDs":[6262],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Tokenize"}}}},"visible":true,"status":{},"columnNames":[]},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UPDATE \"${database}\".\"${schema}\".\"${table}\" set \"${column}\" = \"${ef_database}\".\"${ef_schema}\".\"${ef_tokenize_name}\"(\"${column}\");"}}}},"visible":true,"status":{},"columnNames":[]}},"validationStatus":{},"status":{},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6261":{"id":6261,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":448,"y":16,"width":32,"height":32,"inputConnectorIDs":[6262],"outputSuccessConnectorIDs":[6306],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Tag Column"}}}},"visible":true,"status":{},"columnNames":[]},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ALTER TABLE \"${database}\".\"${schema}\".\"${table}\" ALTER COLUMN \"${column}\" SET TAG ALTR_TOKENIZED = 'true';"}}}},"visible":true,"status":{},"columnNames":[]}},"validationStatus":{},"status":{},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6303":{"id":6303,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":880,"y":16,"width":32,"height":32,"inputConnectorIDs":[8167],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[6351],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"If not added to ALTR"}}}},"visible":true,"status":{},"columnNames":[]},"2":{"slot":2,"name":"Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true,"status":{},"columnNames":[]},"3":{"slot":3,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"is_column_added"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"False"}}}},"visible":true,"status":{},"columnNames":[]},"4":{"slot":4,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true,"status":{},"columnNames":[]},"5":{"slot":5,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{},"columnNames":[]}},"validationStatus":{},"status":{},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6305":{"id":6305,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186829,"x":704,"y":16,"width":32,"height":32,"inputConnectorIDs":[6306],"outputSuccessConnectorIDs":[8167],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Check is_column_added"}}}},"visible":true,"status":{},"columnNames":[]},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print (myvar)\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print (context.getGridVariable('mygridvar'))\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\ncontext.updateVariable('is_column_added', 'True')\ncolumns_to_add_to_altr = context.getGridVariable('columns_to_add_to_altr')\nprint(columns_to_add_to_altr)\nif columns_to_add_to_altr is not None and [column] in columns_to_add_to_altr:\n  context.updateVariable('is_column_added', 'False')\n\n\n\n\n\n\n\n\n"}}}},"visible":true,"status":{},"columnNames":[]},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 3"}}}},"visible":true,"status":{},"columnNames":[]},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true,"status":{},"columnNames":[]},"5":{"slot":5,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false,"status":{},"columnNames":[]}},"validationStatus":{},"status":{},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6312":{"id":6312,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1043089869,"x":1024,"y":16,"width":32,"height":32,"inputConnectorIDs":[6351],"outputSuccessConnectorIDs":[9359],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Add Column To ALTR"}}}},"visible":true,"status":{},"columnNames":[]},"2":{"slot":2,"name":"API","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ALTR Endpoints"}}}},"visible":false,"status":{},"columnNames":[]},"3":{"slot":3,"name":"API Environment","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Production"}}}},"visible":false,"status":{},"columnNames":[]},"4":{"slot":4,"name":"API Version","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"default"}}}},"visible":false,"status":{},"columnNames":[]},"5":{"slot":5,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"POST data"}}}},"visible":true,"status":{},"columnNames":[]},"6":{"slot":6,"name":"Auth Method","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"POST data_auth"}}}},"visible":false,"status":{},"columnNames":[]},"7":{"slot":7,"name":"Api Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false,"status":{},"columnNames":[]},"8":{"slot":8,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${altr_api_key}"}}}},"visible":true,"status":{},"columnNames":[]},"9":{"slot":9,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":"${altr_api_secret_reference}"}}}},"visible":true,"status":{},"columnNames":[]},"10":{"slot":10,"name":"OAuth","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{},"columnNames":[]},"11":{"slot":11,"name":"Page Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"1"}}}},"visible":true,"status":{},"columnNames":[]},"12":{"slot":12,"name":"URI Params","elements":{},"visible":true,"status":{},"columnNames":[]},"13":{"slot":13,"name":"Query Params","elements":{},"visible":true,"status":{},"columnNames":[]},"14":{"slot":14,"name":"Header Params","elements":{},"visible":true,"status":{},"columnNames":[]},"15":{"slot":15,"name":"Post Body","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"{\n    \"databaseId\": ${database_id},\n    \"tableName\": \"${schema}.${table}\",\n    \"columnName\": \"${column}\",\n    \"nickname\": \"${table} ${column}\",\n    \"protectMode\": \"govern\"\n}"}}}},"visible":true,"status":{},"columnNames":[]},"16":{"slot":16,"name":"Api Key Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{},"columnNames":[]},"17":{"slot":17,"name":"Api Key Value","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false,"status":{},"columnNames":[]},"18":{"slot":18,"name":"Bearer Token","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false,"status":{},"columnNames":[]},"22":{"slot":22,"name":"Profile","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ALTR Endpoints"}}}},"visible":true,"status":{},"columnNames":[]},"113":{"slot":113,"name":"Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://matillionetlstaging/"}}}},"visible":true,"status":{},"columnNames":[]},"114":{"slot":114,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true,"status":{},"columnNames":[]},"115":{"slot":115,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true,"status":{},"columnNames":[]},"116":{"slot":116,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true,"status":{},"columnNames":[]},"117":{"slot":117,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"API_RESULTS"}}}},"visible":true,"status":{},"columnNames":[]},"118":{"slot":118,"name":"Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false,"status":{},"columnNames":[]}},"validationStatus":{},"status":{},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"9358":{"id":9358,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":1136,"y":16,"width":32,"height":32,"inputConnectorIDs":[9359],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Edit Masking Policy"}}}},"visible":true,"status":{},"columnNames":[]},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"alter masking policy ${database}.ALTR_DSAAS.\"ALTR_MASKING_POLICY_[${database}].[${schema}].[${table}].[${column}]\" set body ->\n  CASE \n    WHEN TRUE THEN AS_VARCHAR(${ef_database}.${ef_schema}.${ef_detokenize_name}(VALUE, \"${database}\".\"ALTR_DSAAS\".\"ALTR_GOVERN_COLUMN_LAUNCHER_[${database}].[${schema}].[${table}].[${column}]\"(\n        SHA2(CONCAT(\n             COALESCE(LAST_QUERY_ID(),       'null')\n            ,COALESCE(CURRENT_VERSION(),     'null')\n            ,COALESCE(CURRENT_CLIENT(),      'null')\n            ,COALESCE(CURRENT_REGION(),      'null')\n            ,COALESCE(CURRENT_ACCOUNT(),     'null')\n            ,COALESCE(CURRENT_ROLE(),        'null')\n            ,COALESCE(CURRENT_USER(),        'null')\n            ,COALESCE(CURRENT_SESSION(),     'null')\n            ,COALESCE(CURRENT_TRANSACTION(), 'null')\n            ,COALESCE(CURRENT_WAREHOUSE(),   'null')\n            ,COALESCE(CURRENT_DATABASE(),    'null')\n            ,COALESCE(CURRENT_SCHEMA(),      'null')\n            ,COALESCE(CURRENT_STATEMENT(),   'null')\n        ), 256))))\n  END;"}}}},"visible":true,"status":{},"columnNames":[]}},"validationStatus":{},"status":{},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"6262":{"id":6262,"sourceID":6031,"targetID":6261},"6306":{"id":6306,"sourceID":6261,"targetID":6305},"8167":{"id":8167,"sourceID":6305,"targetID":6303},"9359":{"id":9359,"sourceID":6312,"targetID":9358}},"failureConnectors":{},"unconditionalConnectors":{"16891":{"id":16891,"sourceID":6026,"targetID":6031}},"trueConnectors":{"6351":{"id":6351,"sourceID":6303,"targetID":6312}},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"canUndo":true,"undoCommand":"Set Parameter","undoCreated":1677529742155,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"15116":{"id":15116,"x":-36,"y":-152,"width":227,"height":220,"text":"**Tokenize**\n\nCalls __External Function__ to tokenize the values of the column","colour":"e6e63c"},"15123":{"id":15123,"x":328,"y":-153,"width":227,"height":220,"text":"**Snowflake Tagging**\n\nTags column with tag __ALTR_TOKENIZED__value __true__","colour":"e6e63c"},"15147":{"id":15147,"x":643,"y":-141,"width":553,"height":233,"text":"**Add To ALTR and Edit Masking Policy**\n\n1. If the column is not in ALTR, add the column to ALTR\n\n2. Then edit the masking policy to allow for role based dynamic masking (ie Detokenize)","colour":"e6e63c"}},"variables":{"table":{"definition":{"name":"table","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"Default"},"column":{"definition":{"name":"column","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"Default"},"schema":{"definition":{"name":"schema","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"Default"},"database":{"definition":{"name":"database","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"Default"},"ef_schema":{"definition":{"name":"ef_schema","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"${ef_schema}"},"database_id":{"definition":{"name":"database_id","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"1"},"ef_database":{"definition":{"name":"ef_database","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"${ef_database}"},"altr_api_key":{"definition":{"name":"altr_api_key","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"${altr_api_key}"},"s3_bucket_name":{"definition":{"name":"s3_bucket_name","type":"TEXT","scope":"TASKBATCH","description":"Name of the S3 bucket for staging.","visibility":"PUBLIC"},"value":"${s3_bucket_name}"},"is_column_added":{"definition":{"name":"is_column_added","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":null},"ef_tokenize_name":{"definition":{"name":"ef_tokenize_name","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"${ef_tokenize_name}"},"current_classifier":{"definition":{"name":"current_classifier","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"${current_classifier}"},"ef_detokenize_name":{"definition":{"name":"ef_detokenize_name","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"${ef_detokenize_name}"},"altr_api_secret_reference":{"definition":{"name":"altr_api_secret_reference","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"${altr_api_secret_reference}"}},"grids":{"column_json":{"definition":{"name":"column_json","scope":"TASKBATCH","definitions":[{"name":"json_body","type":"TEXT"}],"description":"","visibility":"PRIVATE"},"values":[]},"columns_to_add_to_altr":{"definition":{"name":"columns_to_add_to_altr","scope":"TASKBATCH","definitions":[{"name":"column","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[]}}}},"transformationJobs":{}}],"version":"1.67.7","environment":"snowflake"}